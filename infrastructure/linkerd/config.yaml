---
###
### Linkerd Namespace
###
kind: Namespace
apiVersion: v1
metadata:
  name: linkerd
  annotations:
    linkerd.io/inject: disabled
  labels:
    linkerd.io/is-control-plane: "true"
    config.linkerd.io/admission-webhooks: disabled
    linkerd.io/control-plane-ns: linkerd
---
###
### Identity Controller Service RBAC
###
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-identity
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["authentication.k8s.io"]
  resources: ["tokenreviews"]
  verbs: ["create"]
- apiGroups: ["apps"]
  resources: ["deployments"]
  verbs: ["get"]
- apiGroups: [""]
  resources: ["events"]
  verbs: ["create", "patch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-identity
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-identity
subjects:
- kind: ServiceAccount
  name: linkerd-identity
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-identity
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: identity
    linkerd.io/control-plane-ns: linkerd
---
###
### Destination Controller Service
###
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-destination
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: ["apps"]
  resources: ["replicasets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["batch"]
  resources: ["jobs"]
  verbs: ["list", "get", "watch"]
- apiGroups: [""]
  resources: ["pods", "endpoints", "services", "nodes", "namespaces"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["linkerd.io"]
  resources: ["serviceprofiles"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["split.smi-spec.io"]
  resources: ["trafficsplits"]
  verbs: ["list", "get", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-destination
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-linkerd-destination
subjects:
- kind: ServiceAccount
  name: linkerd-destination
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-destination
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-sp-validator-k8s-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURURENDQWpTZ0F3SUJBZ0lRT2o3OVljWjFNQWV2OWdJZ0RucXlqVEFOQmdrcWhraUc5dzBCQVFzRkFEQXIKTVNrd0p3WURWUVFERXlCc2FXNXJaWEprTFhOd0xYWmhiR2xrWVhSdmNpNXNhVzVyWlhKa0xuTjJZekFlRncweQpNakF5TVRVeU1qUTVOREZhRncweU16QXlNVFV5TWpRNU5ERmFNQ3N4S1RBbkJnTlZCQU1USUd4cGJtdGxjbVF0CmMzQXRkbUZzYVdSaGRHOXlMbXhwYm10bGNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEEKTUlJQkNnS0NBUUVBMG1iMEhDMklvNm8rSjFkV0JzVkxQS3Z4bi9CbzBJVEtNdXB0VzFhbzA5bFZGS2pneWIwTgpsNEFQMjB3eWQ2SmZZaVUvN2ZaTzM2TXYwVlZ2b2NpTElxc2RBWUxoWk0ydElJdERpeHNCbDhXbmdxUXRmK1FNCk1EcVBGbEp6ZVhOaTZVS2tBZ3M3bWFIazk4dWtPY0VRaHR4dWt5VUlBMWl4Q3FBbnN3L2xNZjFpRWRrUDY4YnkKWmttOU5vbUJjakJ3cTNhbWNmaWp5YWVnTU9SYmVYRFkvcHA0UHZlR1A3amZOc2V1anlualA4OGo2TUJ1d09NNQo0SW5aWm05YWxkb2ZxUXBIcHB1K1VGcnpjMmozVk9TNG9sd2tCdkVwSFI1Skx4V1VUUVgvdlloeEhGeHdRL1ZjCjRNYmwzd2RjRXdPNVN1cG4vSEh6VGlPQWZEemwzQXZ1d3dJREFRQUJvMnd3YWpBT0JnTlZIUThCQWY4RUJBTUMKQmFBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQXdHQTFVZEV3RUIvd1FDTUFBdwpLd1lEVlIwUkJDUXdJb0lnYkdsdWEyVnlaQzF6Y0MxMllXeHBaR0YwYjNJdWJHbHVhMlZ5WkM1emRtTXdEUVlKCktvWklodmNOQVFFTEJRQURnZ0VCQURlVGt3YzBhZXNEaE15MUtkWit5eCtZUHNCRVpPNUFYa3o4YkhFbVpwaEoKY0J4Zm5HY2x0WGZ5b0ordTJiWTlTS3VXNUlaWGVFOXlweWE0bUhJK3J4QXRUc09McEtueDBLZFQ4UEU5ZTJHOAorOC9rQmJ1TmNuckJSYmcvQWVsaU0rbmI3K1YzeW5KOWJtbS9UNUQ5N1pFaVVBUjZPREVCSTY0QXcxZ2xBL3hCCjJxeUtLTjczODNKb2RHcThYSkM5ZnlTZDZHbSt1dUdrN0EwMGpEZGlySzZ6d240bGhlQnpEZmQ1aUpTV1l4dGoKRE1HVlFLV2hwWlZqaTJ4NnZGc3hEek1ITnFIbU4vcGhpbS9kRXZ5TVA5WGdHREV1WW5ldzh1RkFVYTRXZGk2RAo3R2RlNmErcVh0b1E0ZE91Nk1MWFg3K0tBTFpJSlpFSWgwMlI2ajA0dnU4PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBMG1iMEhDMklvNm8rSjFkV0JzVkxQS3Z4bi9CbzBJVEtNdXB0VzFhbzA5bFZGS2pnCnliME5sNEFQMjB3eWQ2SmZZaVUvN2ZaTzM2TXYwVlZ2b2NpTElxc2RBWUxoWk0ydElJdERpeHNCbDhXbmdxUXQKZitRTU1EcVBGbEp6ZVhOaTZVS2tBZ3M3bWFIazk4dWtPY0VRaHR4dWt5VUlBMWl4Q3FBbnN3L2xNZjFpRWRrUAo2OGJ5WmttOU5vbUJjakJ3cTNhbWNmaWp5YWVnTU9SYmVYRFkvcHA0UHZlR1A3amZOc2V1anlualA4OGo2TUJ1CndPTTU0SW5aWm05YWxkb2ZxUXBIcHB1K1VGcnpjMmozVk9TNG9sd2tCdkVwSFI1Skx4V1VUUVgvdlloeEhGeHcKUS9WYzRNYmwzd2RjRXdPNVN1cG4vSEh6VGlPQWZEemwzQXZ1d3dJREFRQUJBb0lCQVFDcEw4WmRualBBdjVXcApGdTZERlVUeHJhWG5JVzkzTlVCT2Z2bWV0K21jS0tma3JBUE4xU3JIeDE5NHpTWEwwNUoxbmxSdzZsMzBNUW16CmY4cjdRZ0szeHZiVkQwUmxSWXBRb0F1WklRYy8zdDFiRE4vVmRqQmkyOFBSaEUxOHZNOHRtTHUvTlA4aEEvRFYKWFRoYWhLZmdlZ0trYWVPdXBUUC93bGNLQXQ4Zk9SYlJSNDJtcVZxQ1plZFdMb1BlbXgvbEJBaEl5QklOZkl3TgpOamZUSTZkUjF2N0ZqVnRKT3JhSnlPZ21wa1VMemk0SHZTQXBrZk9QZ0hBY2VIOHVsNnBCcjExRkdaL2hOeitPCmtSamVya2MyY2Q1dE9wUEx1Nkt3MEwrQTd6K1U5dldub0c2bCtUL0dRSjJYUDVNN01jNlhxQzhJUStZQzlSL2sKVlJXL090UXBBb0dCQU9iZGhZYVdseVFrL3EraWpnbStKdzI5Qk44em13OHFyQlVuS1h1aWRrQ1d5azIxbmkxVgpnUS9tOWJmNjlmRWpnZVdhMjNZRU5DUEZpeis2c2xFUzJpdWwyUlpoeVFYblE1eDFXS08wNERUdVNXYlh3ak1aCkV2UHdMUTlmNlZZUFhPREgvSHNIdlQwTTliY3JyMGdOaVhHc081dWQyUHNlWFh4MzhEZVI4UDVYQW9HQkFPbFAKR2IrcFBhZUZOUzlDNzVTU2pCUGhVSEZaYS9EaDBCOG5Ia09xVkNmcjJkSUk3WjMvMXdqSUlDNzEzdy83REpVUgp4aGlZaUNRUy82YkVrc0w0dEZveHNWRUpWSmZYQXlnbmx2anZzYldWbkJRbDA4ekIxeU9UMzUrRHJoS3duR3FxCkZjVEZwcThIQXVjTWkrN0NMWVhuYmRueDREOE5kUjZ2QzdBdjlUZDFBb0dBSHd1WkFpRk1EOXM5dUlhbWpSN2EKQjVuc2hzdGN4YXhhV2JuYmRUbkNweXJmNTVWTndSRG5leWoyMEJmYWJPUDJldGJaUGtTUWNtTUZON3UyY1BxVgpCaHVXVnRFdGhESzJQOXJ6NFlmWVFxWHNqdnppcTVacW13MG9NaElXd2JEdEwza1ZOY0l6cTNzTHErY2UraFIvCjhCNVdJYllYVUtXanNySTZSbTdFdHA4Q2dZRUFtZ0FQYy9hSGJ0czdwdTJjN01ucTBuaUlPN21WeVZPVXArdVAKUzRUVHRlSTFUakY4ZnkxUHlFa3BEVFpZUGRrdGpmeEVjUm5GeTJJTEJBNSsvVmxpMnFJd2M5Z2YwWFlvYkVudAptblhGTEtJTGV6VVkzL0FYVFRHZmkxQkZCNnN5SkNvTzRtckF3b2x6UGdXSEhGdHA1eGhDNTNpRDE3clBVeWlpCkkzTVVmcjBDZ1lBdGFLdGhOR1RORW9NKzJqZHhQSnZxbm54WXlxelNFTXFJNm5RZFdQRU9CbVhPeno2WVZrWk8KeElnZENhQW1GditnRUk5bHdlRUFtd3BLUXdDT2RNMm9LbEkyYWdHZjlnK0I4TXhvM1IxQkpzQ0dmdU4vdUJVMgprR012WFRkUE9MdzZVZ3lkRFBLYjlQYkhJaWR4ZEpWM2VsMEpSOGQxc29HTWRrUzdTcWRNUUE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: linkerd-sp-validator-webhook-config
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
webhooks:
- name: linkerd-sp-validator.linkerd.io
  namespaceSelector:
    matchExpressions:
    - key: config.linkerd.io/admission-webhooks
      operator: NotIn
      values:
      - disabled
  clientConfig:
    service:
      name: linkerd-sp-validator
      namespace: linkerd
      path: "/"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURURENDQWpTZ0F3SUJBZ0lRT2o3OVljWjFNQWV2OWdJZ0RucXlqVEFOQmdrcWhraUc5dzBCQVFzRkFEQXIKTVNrd0p3WURWUVFERXlCc2FXNXJaWEprTFhOd0xYWmhiR2xrWVhSdmNpNXNhVzVyWlhKa0xuTjJZekFlRncweQpNakF5TVRVeU1qUTVOREZhRncweU16QXlNVFV5TWpRNU5ERmFNQ3N4S1RBbkJnTlZCQU1USUd4cGJtdGxjbVF0CmMzQXRkbUZzYVdSaGRHOXlMbXhwYm10bGNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEEKTUlJQkNnS0NBUUVBMG1iMEhDMklvNm8rSjFkV0JzVkxQS3Z4bi9CbzBJVEtNdXB0VzFhbzA5bFZGS2pneWIwTgpsNEFQMjB3eWQ2SmZZaVUvN2ZaTzM2TXYwVlZ2b2NpTElxc2RBWUxoWk0ydElJdERpeHNCbDhXbmdxUXRmK1FNCk1EcVBGbEp6ZVhOaTZVS2tBZ3M3bWFIazk4dWtPY0VRaHR4dWt5VUlBMWl4Q3FBbnN3L2xNZjFpRWRrUDY4YnkKWmttOU5vbUJjakJ3cTNhbWNmaWp5YWVnTU9SYmVYRFkvcHA0UHZlR1A3amZOc2V1anlualA4OGo2TUJ1d09NNQo0SW5aWm05YWxkb2ZxUXBIcHB1K1VGcnpjMmozVk9TNG9sd2tCdkVwSFI1Skx4V1VUUVgvdlloeEhGeHdRL1ZjCjRNYmwzd2RjRXdPNVN1cG4vSEh6VGlPQWZEemwzQXZ1d3dJREFRQUJvMnd3YWpBT0JnTlZIUThCQWY4RUJBTUMKQmFBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQXdHQTFVZEV3RUIvd1FDTUFBdwpLd1lEVlIwUkJDUXdJb0lnYkdsdWEyVnlaQzF6Y0MxMllXeHBaR0YwYjNJdWJHbHVhMlZ5WkM1emRtTXdEUVlKCktvWklodmNOQVFFTEJRQURnZ0VCQURlVGt3YzBhZXNEaE15MUtkWit5eCtZUHNCRVpPNUFYa3o4YkhFbVpwaEoKY0J4Zm5HY2x0WGZ5b0ordTJiWTlTS3VXNUlaWGVFOXlweWE0bUhJK3J4QXRUc09McEtueDBLZFQ4UEU5ZTJHOAorOC9rQmJ1TmNuckJSYmcvQWVsaU0rbmI3K1YzeW5KOWJtbS9UNUQ5N1pFaVVBUjZPREVCSTY0QXcxZ2xBL3hCCjJxeUtLTjczODNKb2RHcThYSkM5ZnlTZDZHbSt1dUdrN0EwMGpEZGlySzZ6d240bGhlQnpEZmQ1aUpTV1l4dGoKRE1HVlFLV2hwWlZqaTJ4NnZGc3hEek1ITnFIbU4vcGhpbS9kRXZ5TVA5WGdHREV1WW5ldzh1RkFVYTRXZGk2RAo3R2RlNmErcVh0b1E0ZE91Nk1MWFg3K0tBTFpJSlpFSWgwMlI2ajA0dnU4PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t
  failurePolicy: Ignore
  admissionReviewVersions: ["v1", "v1beta1"]
  rules:
  - operations: ["CREATE", "UPDATE"]
    apiGroups: ["linkerd.io"]
    apiVersions: ["v1alpha1", "v1alpha2"]
    resources: ["serviceprofiles"]
  sideEffects: None
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-policy-validator-k8s-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURXVENDQWtHZ0F3SUJBZ0lSQUw1emh5QWlVVGNYWlpMSmh0WjF2WFl3RFFZSktvWklodmNOQVFFTEJRQXcKTHpFdE1Dc0dBMVVFQXhNa2JHbHVhMlZ5WkMxd2IyeHBZM2t0ZG1Gc2FXUmhkRzl5TG14cGJtdGxjbVF1YzNaagpNQjRYRFRJeU1ESXhOVEl5TkRrME1Wb1hEVEl6TURJeE5USXlORGswTVZvd0x6RXRNQ3NHQTFVRUF4TWtiR2x1CmEyVnlaQzF3YjJ4cFkza3RkbUZzYVdSaGRHOXlMbXhwYm10bGNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEIKQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdTlqY3lpc2Mzc2E5cmtxRlhXYUhYRUNTci9kM1l3UEtIQ20xK3V2awptYXFqMUZLRyt6eDB2WkhSSjBnVnNXZEx0VVZnMTVhdmxDSitxOUthOWF5SEVrRW5TUVBmaGMva0FCcDBEdUk2Ci9YYWVKZ3VWK1NYdFk2ZEdlRUNZOFNmcng2WHV1V1gxQ2FJazhzU1NRTnVDV2gxbW1zdmdCejMxZ2VUbXNIV3cKeUhUbE1ORy9lcm9HN1RFSWhibEZOWTRGM0VZalBEbjliSGwxMDZjOXhaV0tkNm0yeHV5bm9iZGZ3Tm9EeDY1ZQpNeHk4NUlUY1oyVEs5anBscGJwZURzZVEzOHFicnB6ZjJHTEpJMFhNOU9jQ254c0RCWWxSVjlnbHBDRzM4V25uClVHaFVsdDVDMVZrZVM4a1hQcVc5emFmSXp2SFY2UDFXdmZicldrOGpUVklJblFJREFRQUJvM0F3YmpBT0JnTlYKSFE4QkFmOEVCQU1DQmFBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQXdHQTFVZApFd0VCL3dRQ01BQXdMd1lEVlIwUkJDZ3dKb0lrYkdsdWEyVnlaQzF3YjJ4cFkza3RkbUZzYVdSaGRHOXlMbXhwCmJtdGxjbVF1YzNaak1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQUxZOEtEVXE3bjNSakRzbTlZVkpKTEZVdXMKdEdLTHRBbC9LV3E4L0NXUThRRGVHckltZXNKYm1qam1ScWxvM2JOaEJMR2JvQVJ5bVBlZnNlQlBUZ3hiTjAwbQpqbC9wdWpKYUxtUXhuM0FYV1hRSDBuQjJGUzd2R0o4TWZNMXZCVnVxV1hDeHJmZWlyTXBqNkJ0L29iVmF5VTlLClEvbSszS2p5Y3RraXBIWDJpTUd5bzg4MjF2TDJBTnc1NEhaLzBtZElvOUZJbFk1dXBBM0t5MU16dTFKbGorRHoKOXhuN3NFZ3VKRm9lSy9BaFlhdHlTd1B5cmN2TGFYSGZ4Y2tQeWZRL3psZ3o0L29ua1V0c0F5NVF4eEhGS05yaApDWVNLci9zYVArVXY1WlJhZU0vWXNPRzFtbTBoVjNQb2NvNXk5azVMTDllN3JaWXlsbTN3NEowUkh4K2QKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdTlqY3lpc2Mzc2E5cmtxRlhXYUhYRUNTci9kM1l3UEtIQ20xK3V2a21hcWoxRktHCit6eDB2WkhSSjBnVnNXZEx0VVZnMTVhdmxDSitxOUthOWF5SEVrRW5TUVBmaGMva0FCcDBEdUk2L1hhZUpndVYKK1NYdFk2ZEdlRUNZOFNmcng2WHV1V1gxQ2FJazhzU1NRTnVDV2gxbW1zdmdCejMxZ2VUbXNIV3d5SFRsTU5HLwplcm9HN1RFSWhibEZOWTRGM0VZalBEbjliSGwxMDZjOXhaV0tkNm0yeHV5bm9iZGZ3Tm9EeDY1ZU14eTg1SVRjCloyVEs5anBscGJwZURzZVEzOHFicnB6ZjJHTEpJMFhNOU9jQ254c0RCWWxSVjlnbHBDRzM4V25uVUdoVWx0NUMKMVZrZVM4a1hQcVc5emFmSXp2SFY2UDFXdmZicldrOGpUVklJblFJREFRQUJBb0lCQVFDY3FqY3FIVjdNcGJBWQpwbW9vQlpTcTZlZnMvbFVCclcxb281ajBscnhuTkp2Q1BybjQydWo2R1p6NFIvUmZxcWpIbS84eWpxZ013ZUFuCmFWUjN4Tlk1OFVEVWNuaC9YMnptY1NtT0tEdk9uSmsxWGNCTXRNY1JyN2JrSCt2dVpMOE9HV1BLR0RDUFFqM1MKZ3dML09KTzBtSVMwWVlpTVFhNTZFUEFkQjJyVElzeThQU2VCU21QSnFkeUQ0WWV3Z1Z1K3Rab3VxZmFKc2FLWQp2b1BFTjJ2Um0vWVN4QnI2UWpGR2NIQmpKNEVlSUtpT05ub0laUEZ2K3ltZk1zdHJncy9QdllzcFp3ejJXQVkwCnl4bGh5YlgySGdaaTRkYnBhVEU0RElPbktqVkFkN3FYQ1RpbnVFVVIxSnhpT090SExHN0lBbjBNbys3USt1V2EKWVJSNFZQeDVBb0dCQU5GTE5OelB3c1FqM2R0bGpQSmRUTmlEc3J2NmhYK1B2NjV0QWRJRzRhTnlEd0lkWm1ETwpZK0NoVzlQWEhLSlNpRWRPSngxeVpGaTc2Q3N3WW1LK3VBUFd6WUtjSDAwd0RvZ1FRQ0c5bFZIN0JsMXJrMUp1CkN0bURrSUhCSmtpYzZuazFXWTNNdHNqVDIrLzZqREF1dnZocDdrdTlEQ09COGU0YzIvTUFueWxqQW9HQkFPWEUKYk1SQUFDN1RDbHowM2lMdVBvUUF3Q3pRQmJnMmhTdXF6RGZQR1hHNElNcVJxa0gvNWx3aUQ1ZTBJYmZOMzlndgpFN3ZDT2VmL3dQaU1UM2ttOGtmNS9EYVRMWkw0TUwvWkdRZkFldHhTVjJDZ0hUeUxaYjBOMVhSQ0RhbC9ucjJnCmJpbFRLQVZVbGJ5RERUV2EwNTJ2NWxZM0VPUnphMVdEQ1dZNjZhWC9Bb0dBYUVjdFhudFJra0pBanNpcEVqUzAKVGdoSUxHcWt5eXJIR1ZRTW5TVjZsT0lHWWtwZHNRd0VMVzZYL3hObG0rYTlLYkhod1VVMmhCT1RtTGt4dS90RQpXZjFUUmFrZDIycC9Rd0c5d2xIZ0xRbUNZVmR3L3BmL1plS3NSRW9GRmhiQXFJV1JTaHBlVSs5aTNNMmJ2WUg4CittNWxJVzFldCs1TnFSTE43K1EyYVBzQ2dZRUEybjdxTjgzczNwcE9Ob3VkV25aWStNcUY5WmQwZVBOUHZIRFYKZHhUNFMwNGYwTUtvdDg2VHozV01nbVVIMDNSeHMzRkJRTUc0czBoZ3gzc1djRTE3Qkx0Uy9zc0RBY29IQWNsLwpwZ0dDVkZYeFJhKzlYYi9wNWRocjdmeUtaVzg1RTNhbWk2SEtZeGRHdFZlaWppRkhyNktBVmVoVHBndWtQRk01Cjh2OS9CUjBDZ1lCeU5HdEVRdlA1dm1wa3F0eHZPbGlQdk1XbXpieFdXZHAzRXRwUnJGZHJnSTFqVFRvUWR2cGIKdEhhTzRNUVZPTDNtUm1UVENmMGpWaW1QdUUvUWRvQWpLd2dPeWVMbUFlQ055VTF2SXJkMTcyZG8xcVZIUjVqNgpneEVNWHB6Q044ZmxIbFR4QStOdm5LWWZmRVRhRTREWFYvM0RCSmZZd1M0SVhOS0xwYVdXTnc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: linkerd-policy-validator-webhook-config
  labels:
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
webhooks:
- name: linkerd-policy-validator.linkerd.io
  namespaceSelector:
    matchExpressions:
    - key: config.linkerd.io/admission-webhooks
      operator: NotIn
      values:
      - disabled
  clientConfig:
    service:
      name: linkerd-policy-validator
      namespace: linkerd
      path: "/"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURXVENDQWtHZ0F3SUJBZ0lSQUw1emh5QWlVVGNYWlpMSmh0WjF2WFl3RFFZSktvWklodmNOQVFFTEJRQXcKTHpFdE1Dc0dBMVVFQXhNa2JHbHVhMlZ5WkMxd2IyeHBZM2t0ZG1Gc2FXUmhkRzl5TG14cGJtdGxjbVF1YzNaagpNQjRYRFRJeU1ESXhOVEl5TkRrME1Wb1hEVEl6TURJeE5USXlORGswTVZvd0x6RXRNQ3NHQTFVRUF4TWtiR2x1CmEyVnlaQzF3YjJ4cFkza3RkbUZzYVdSaGRHOXlMbXhwYm10bGNtUXVjM1pqTUlJQklqQU5CZ2txaGtpRzl3MEIKQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBdTlqY3lpc2Mzc2E5cmtxRlhXYUhYRUNTci9kM1l3UEtIQ20xK3V2awptYXFqMUZLRyt6eDB2WkhSSjBnVnNXZEx0VVZnMTVhdmxDSitxOUthOWF5SEVrRW5TUVBmaGMva0FCcDBEdUk2Ci9YYWVKZ3VWK1NYdFk2ZEdlRUNZOFNmcng2WHV1V1gxQ2FJazhzU1NRTnVDV2gxbW1zdmdCejMxZ2VUbXNIV3cKeUhUbE1ORy9lcm9HN1RFSWhibEZOWTRGM0VZalBEbjliSGwxMDZjOXhaV0tkNm0yeHV5bm9iZGZ3Tm9EeDY1ZQpNeHk4NUlUY1oyVEs5anBscGJwZURzZVEzOHFicnB6ZjJHTEpJMFhNOU9jQ254c0RCWWxSVjlnbHBDRzM4V25uClVHaFVsdDVDMVZrZVM4a1hQcVc5emFmSXp2SFY2UDFXdmZicldrOGpUVklJblFJREFRQUJvM0F3YmpBT0JnTlYKSFE4QkFmOEVCQU1DQmFBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQXdHQTFVZApFd0VCL3dRQ01BQXdMd1lEVlIwUkJDZ3dKb0lrYkdsdWEyVnlaQzF3YjJ4cFkza3RkbUZzYVdSaGRHOXlMbXhwCmJtdGxjbVF1YzNaak1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQUxZOEtEVXE3bjNSakRzbTlZVkpKTEZVdXMKdEdLTHRBbC9LV3E4L0NXUThRRGVHckltZXNKYm1qam1ScWxvM2JOaEJMR2JvQVJ5bVBlZnNlQlBUZ3hiTjAwbQpqbC9wdWpKYUxtUXhuM0FYV1hRSDBuQjJGUzd2R0o4TWZNMXZCVnVxV1hDeHJmZWlyTXBqNkJ0L29iVmF5VTlLClEvbSszS2p5Y3RraXBIWDJpTUd5bzg4MjF2TDJBTnc1NEhaLzBtZElvOUZJbFk1dXBBM0t5MU16dTFKbGorRHoKOXhuN3NFZ3VKRm9lSy9BaFlhdHlTd1B5cmN2TGFYSGZ4Y2tQeWZRL3psZ3o0L29ua1V0c0F5NVF4eEhGS05yaApDWVNLci9zYVArVXY1WlJhZU0vWXNPRzFtbTBoVjNQb2NvNXk5azVMTDllN3JaWXlsbTN3NEowUkh4K2QKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==
  failurePolicy: Ignore
  admissionReviewVersions: ["v1", "v1beta1"]
  rules:
  - operations: ["CREATE", "UPDATE"]
    apiGroups: ["policy.linkerd.io"]
    apiVersions: ["v1alpha1", "v1beta1"]
    resources: ["servers"]
  sideEffects: None
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: linkerd-policy
  labels:
    app.kubernetes.io/part-of: Linkerd
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
rules:
  - apiGroups:
      - ""
    resources:
      - pods
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - policy.linkerd.io
    resources:
      - servers
      - serverauthorizations
    verbs:
      - get
      - list
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: linkerd-destination-policy
  labels:
    app.kubernetes.io/part-of: Linkerd
    linkerd.io/control-plane-component: destination
    linkerd.io/control-plane-ns: linkerd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: linkerd-policy
subjects:
  - kind: ServiceAccount
    name: linkerd-destination
    namespace: linkerd
---
###
### Heartbeat RBAC
###
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["configmaps"]
  verbs: ["get"]
  resourceNames: ["linkerd-config"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: Role
  name: linkerd-heartbeat
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-heartbeat
  namespace: linkerd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: linkerd-heartbeat
  labels:
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["namespaces"]
  verbs: ["list"]
- apiGroups: ["linkerd.io"]
  resources: ["serviceprofiles"]
  verbs: ["list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: linkerd-heartbeat
  labels:
    linkerd.io/control-plane-ns: linkerd
roleRef:
  kind: ClusterRole
  name: linkerd-heartbeat
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: linkerd-heartbeat
  namespace: linkerd
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-heartbeat
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: heartbeat
    linkerd.io/control-plane-ns: linkerd
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: servers.policy.linkerd.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: policy.linkerd.io
  names:
    kind: Server
    plural: servers
    singular: server
    shortNames: [srv]
  scope: Namespaced
  versions:
    - name: v1alpha1
      served: true
      storage: false
      schema:
        openAPIV3Schema:
          type: object
          required: [spec]
          properties:
            spec:
              type: object
              required:
                - podSelector
                - port
              properties:
                podSelector:
                  type: object
                  description: >-
                    Selects pods in the same namespace.
                  oneOf:
                    - required: [matchExpressions]
                    - required: [matchLabels]
                  properties:
                    matchLabels:
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    matchExpressions:
                      type: array
                      items:
                        type: object
                        required: [key, operator]
                        properties:
                          key:
                            type: string
                          operator:
                            type: string
                            enum: [In, NotIn, Exists, DoesNotExist]
                          values:
                            type: array
                            items:
                              type: string
                port:
                  description: >-
                    A port name or number. Must exist in a pod spec.
                  x-kubernetes-int-or-string: true
                proxyProtocol:
                  description: >-
                    Configures protocol discovery for inbound connections.

                    Supersedes the `config.linkerd.io/opaque-ports` annotation.
                  type: string
                  default: unknown
                  enum:
                    - unknown
                    - HTTP/1
                    - HTTP/2
                    - gRPC
                    - opaque
                    - TLS
    - name: v1beta1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          required: [spec]
          properties:
            spec:
              type: object
              required:
                - podSelector
                - port
              properties:
                podSelector:
                  type: object
                  description: >-
                    Selects pods in the same namespace.
                  oneOf:
                    - required: [matchExpressions]
                    - required: [matchLabels]
                  properties:
                    matchLabels:
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    matchExpressions:
                      type: array
                      items:
                        type: object
                        required: [key, operator]
                        properties:
                          key:
                            type: string
                          operator:
                            type: string
                            enum: [In, NotIn, Exists, DoesNotExist]
                          values:
                            type: array
                            items:
                              type: string
                port:
                  description: >-
                    A port name or number. Must exist in a pod spec.
                  x-kubernetes-int-or-string: true
                proxyProtocol:
                  description: >-
                    Configures protocol discovery for inbound connections.

                    Supersedes the `config.linkerd.io/opaque-ports` annotation.
                  type: string
                  default: unknown
                  enum:
                    - unknown
                    - HTTP/1
                    - HTTP/2
                    - gRPC
                    - opaque
                    - TLS
      additionalPrinterColumns:
      - name: Port
        type: string
        description: The port the server is listening on
        jsonPath: .spec.port
      - name: Protocol
        type: string
        description: The protocol of the server
        jsonPath: .spec.proxyProtocol
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: serverauthorizations.policy.linkerd.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: policy.linkerd.io
  scope: Namespaced
  names:
    kind: ServerAuthorization
    plural: serverauthorizations
    singular: serverauthorization
    shortNames: [saz]
  versions:
    - name: v1alpha1
      served: true
      storage: false
      schema:
        openAPIV3Schema:
          type: object
          required: [spec]
          properties:
            spec:
              description: >-
                Authorizes clients to communicate with Linkerd-proxied servers.
              type: object
              required: [server, client]
              properties:
                server:
                  description: >-
                    Identifies servers in the same namespace for which this
                    authorization applies.

                    Only one of `name` or `selector` may be specified.
                  type: object
                  oneOf:
                    - required: [name]
                    - required: [selector]
                  properties:
                    name:
                      description: References a `Server` instance by name
                      type: string
                      pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
                    selector:
                      description: >-
                        A label query over servers on which this authorization applies.
                      type: object
                      oneOf:
                        - required: [matchLabels]
                        - required: [matchExpressions]
                      properties:
                        matchLabels:
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        matchExpressions:
                          type: array
                          items:
                            type: object
                            required: [key, operator]
                            properties:
                              key:
                                type: string
                              operator:
                                type: string
                                enum: [In, NotIn, Exists, DoesNotExist]
                              values:
                                type: array
                                items:
                                  type: string
                client:
                  description:  Describes clients authorized to access a server.
                  type: object
                  oneOf:
                    - required: [meshTLS]
                    - required: [unauthenticated]
                  properties:
                    networks:
                      description: >-
                        Limits the client IP addresses to which this
                        authorization applies. If unset, the server chooses a
                        default (typically, all IPs or the cluster's pod
                        network).
                      type: array
                      items:
                        type: object
                        required: [cidr]
                        properties:
                          cidr:
                            type: string
                          except:
                            type: array
                            items:
                              type: string
                    unauthenticated:
                      description: >-
                        Authorizes unauthenticated clients to access a server.
                      type: boolean
                    meshTLS:
                      type: object
                      oneOf:
                        - required: [unauthenticatedTLS]
                        - required: [identities]
                        - required: [serviceAccounts]
                      properties:
                        unauthenticatedTLS:
                          type: boolean
                          description: >-
                            Indicates that no client identity is required for
                            communication.

                            This is mostly important for the identity
                            controller, which must terminate TLS connections
                            from clients that do not yet have a certificate.
                        identities:
                          description: >-
                            Authorizes clients with the provided proxy identity
                            strings (as provided via MTLS)

                            The `*` prefix can be used to match all identities in
                            a domain. An identity string of `*` indicates that
                            all authentication clients are authorized.
                          type: array
                          items:
                            type: string
                            pattern: '^(\*|[a-z0-9]([-a-z0-9]*[a-z0-9])?)(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$'
                        serviceAccounts:
                          description: >-
                            Authorizes clients with the provided proxy identity
                            service accounts (as provided via MTLS)
                          type: array
                          items:
                            type: object
                            required: [name]
                            properties:
                              name:
                                description: The ServiceAccount's name.
                                type: string
                                pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
                              namespace:
                                description: >-
                                  The ServiceAccount's namespace. If unset, the
                                  authorization's namespace is used.
                                type: string
                                pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
    - name: v1beta1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          required: [spec]
          properties:
            spec:
              description: >-
                Authorizes clients to communicate with Linkerd-proxied servers.
              type: object
              required: [server, client]
              properties:
                server:
                  description: >-
                    Identifies servers in the same namespace for which this
                    authorization applies.

                    Only one of `name` or `selector` may be specified.
                  type: object
                  oneOf:
                    - required: [name]
                    - required: [selector]
                  properties:
                    name:
                      description: References a `Server` instance by name
                      type: string
                      pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
                    selector:
                      description: >-
                        A label query over servers on which this authorization applies.
                      type: object
                      oneOf:
                        - required: [matchLabels]
                        - required: [matchExpressions]
                      properties:
                        matchLabels:
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        matchExpressions:
                          type: array
                          items:
                            type: object
                            required: [key, operator]
                            properties:
                              key:
                                type: string
                              operator:
                                type: string
                                enum: [In, NotIn, Exists, DoesNotExist]
                              values:
                                type: array
                                items:
                                  type: string
                client:
                  description:  Describes clients authorized to access a server.
                  type: object
                  oneOf:
                    - required: [meshTLS]
                    - required: [unauthenticated]
                  properties:
                    networks:
                      description: >-
                        Limits the client IP addresses to which this
                        authorization applies. If unset, the server chooses a
                        default (typically, all IPs or the cluster's pod
                        network).
                      type: array
                      items:
                        type: object
                        required: [cidr]
                        properties:
                          cidr:
                            type: string
                          except:
                            type: array
                            items:
                              type: string
                    unauthenticated:
                      description: >-
                        Authorizes unauthenticated clients to access a server.
                      type: boolean
                    meshTLS:
                      type: object
                      oneOf:
                        - required: [unauthenticatedTLS]
                        - required: [identities]
                        - required: [serviceAccounts]
                      properties:
                        unauthenticatedTLS:
                          type: boolean
                          description: >-
                            Indicates that no client identity is required for
                            communication.

                            This is mostly important for the identity
                            controller, which must terminate TLS connections
                            from clients that do not yet have a certificate.
                        identities:
                          description: >-
                            Authorizes clients with the provided proxy identity
                            strings (as provided via MTLS)

                            The `*` prefix can be used to match all identities in
                            a domain. An identity string of `*` indicates that
                            all authentication clients are authorized.
                          type: array
                          items:
                            type: string
                            pattern: '^(\*|[a-z0-9]([-a-z0-9]*[a-z0-9])?)(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$'
                        serviceAccounts:
                          description: >-
                            Authorizes clients with the provided proxy identity
                            service accounts (as provided via MTLS)
                          type: array
                          items:
                            type: object
                            required: [name]
                            properties:
                              name:
                                description: The ServiceAccount's name.
                                type: string
                                pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
                              namespace:
                                description: >-
                                  The ServiceAccount's namespace. If unset, the
                                  authorization's namespace is used.
                                type: string
                                pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
      additionalPrinterColumns:
      - name: Server
        type: string
        description: The server that this grants access to
        jsonPath: .spec.server.name
---
###
### Service Profile CRD
###
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: serviceprofiles.linkerd.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: linkerd.io
  versions:
  - name: v1alpha1
    served: true
    storage: false
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            description: Spec is the custom resource spec
            required:
            - routes
            properties:
              dstOverrides:
                type: array
                required:
                - authority
                - weight
                items:
                  type: object
                  description: WeightedDst is a weighted alternate destination.
                  properties:
                    authority:
                      type: string
                    weight:
                      x-kubernetes-int-or-string: true
                      anyOf:
                      - type: integer
                      - type: string
                      pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
              opaquePorts:
                type: array
                items:
                  type: string
              retryBudget:
                type: object
                required:
                - minRetriesPerSecond
                - retryRatio
                - ttl
                description: RetryBudget describes the maximum number of retries that should be issued to this service.
                properties:
                  minRetriesPerSecond:
                    format: int32
                    type: integer
                  retryRatio:
                    type: number
                    format: float
                  ttl:
                    type: string
              routes:
                type: array
                items:
                  type: object
                  description: RouteSpec specifies a Route resource.
                  required:
                  - condition
                  - name
                  properties:
                    condition:
                      type: object
                      description: RequestMatch describes the conditions under which to match a Route.
                      properties:
                        pathRegex:
                          type: string
                        method:
                          type: string
                        all:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                        any:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                        not:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                    isRetryable:
                      type: boolean
                    name:
                      type: string
                    timeout:
                      type: string
                    responseClasses:
                      type: array
                      items:
                        type: object
                        required:
                        - condition
                        description: ResponseClass describes how to classify a response (e.g. success or failures).
                        properties:
                          condition:
                            type: object
                            description: ResponseMatch describes the conditions under
                              which to classify a response.
                            properties:
                              all:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              any:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              not:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              status:
                                type: object
                                description: Range describes a range of integers (e.g. status codes).
                                properties:
                                  max:
                                    format: int32
                                    type: integer
                                  min:
                                    format: int32
                                    type: integer
                          isFailure:
                            type: boolean
  - name: v1alpha2
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            description: Spec is the custom resource spec
            properties:
              dstOverrides:
                type: array
                required:
                - authority
                - weight
                items:
                  type: object
                  description: WeightedDst is a weighted alternate destination.
                  properties:
                    authority:
                      type: string
                    weight:
                      x-kubernetes-int-or-string: true
                      anyOf:
                      - type: integer
                      - type: string
                      pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
              opaquePorts:
                type: array
                items:
                  type: string
              retryBudget:
                type: object
                required:
                - minRetriesPerSecond
                - retryRatio
                - ttl
                description: RetryBudget describes the maximum number of retries that should be issued to this service.
                properties:
                  minRetriesPerSecond:
                    format: int32
                    type: integer
                  retryRatio:
                    type: number
                    format: float
                  ttl:
                    type: string
              routes:
                type: array
                items:
                  type: object
                  description: RouteSpec specifies a Route resource.
                  required:
                  - condition
                  - name
                  properties:
                    condition:
                      type: object
                      description: RequestMatch describes the conditions under which to match a Route.
                      properties:
                        pathRegex:
                          type: string
                        method:
                          type: string
                        all:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                        any:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                        not:
                          type: array
                          items:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                    isRetryable:
                      type: boolean
                    name:
                      type: string
                    timeout:
                      type: string
                    responseClasses:
                      type: array
                      items:
                        type: object
                        required:
                        - condition
                        description: ResponseClass describes how to classify a response (e.g. success or failures).
                        properties:
                          condition:
                            type: object
                            description: ResponseMatch describes the conditions under
                              which to classify a response.
                            properties:
                              all:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              any:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              not:
                                type: array
                                items:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                              status:
                                type: object
                                description: Range describes a range of integers (e.g. status codes).
                                properties:
                                  max:
                                    format: int32
                                    type: integer
                                  min:
                                    format: int32
                                    type: integer
                          isFailure:
                            type: boolean
  scope: Namespaced
  preserveUnknownFields: false
  names:
    plural: serviceprofiles
    singular: serviceprofile
    kind: ServiceProfile
    shortNames:
    - sp
---
###
### TrafficSplit CRD
### Copied from github.com/servicemeshinterface/smi-sdk-go/blob/d4e76b1cd7a33ead5f38d1262dd838a31c80f4e5/crds/split.yaml
###
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: trafficsplits.split.smi-spec.io
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
  labels:
    linkerd.io/control-plane-ns: linkerd
spec:
  group: split.smi-spec.io
  scope: Namespaced
  conversion:
    strategy: None
  names:
    kind: TrafficSplit
    listKind: TrafficSplitList
    shortNames:
      - ts
    plural: trafficsplits
    singular: trafficsplit
  versions:
    - name: v1alpha1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              required:
                - service
                - backends
              properties:
                service:
                  description: The apex service of this split.
                  type: string
                backends:
                  description: The backend services of this split.
                  type: array
                  items:
                    type: object
                    required: ['service', 'weight']
                    properties:
                      service:
                        description: Name of the Kubernetes service.
                        type: string
                      weight:
                        description: Traffic weight value of this backend.
                        x-kubernetes-int-or-string: true
      additionalPrinterColumns:
      - name: Service
        type: string
        description: The apex service of this split.
        jsonPath: .spec.service
    - name: v1alpha2
      served: true
      storage: false
      additionalPrinterColumns:
      - name: Service
        type: string
        description: The apex service of this split.
        jsonPath: .spec.service
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              required:
                - service
                - backends
              properties:
                service:
                  description: The apex service of this split.
                  type: string
                backends:
                  description: The backend services of this split.
                  type: array
                  items:
                    type: object
                    required: ['service', 'weight']
                    properties:
                      service:
                        description: Name of the Kubernetes service.
                        type: string
                      weight:
                        description: Traffic weight value of this backend.
                        type: number
  preserveUnknownFields: false
---
###
### Proxy Injector RBAC
###
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-proxy-injector
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
rules:
- apiGroups: [""]
  resources: ["events"]
  verbs: ["create", "patch"]
- apiGroups: [""]
  resources: ["namespaces", "replicationcontrollers"]
  verbs: ["list", "get", "watch"]
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["list", "watch"]
- apiGroups: ["extensions", "apps"]
  resources: ["deployments", "replicasets", "daemonsets", "statefulsets"]
  verbs: ["list", "get", "watch"]
- apiGroups: ["extensions", "batch"]
  resources: ["cronjobs", "jobs"]
  verbs: ["list", "get", "watch"]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: linkerd-linkerd-proxy-injector
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
subjects:
- kind: ServiceAccount
  name: linkerd-proxy-injector
  namespace: linkerd
  apiGroup: ""
roleRef:
  kind: ClusterRole
  name: linkerd-linkerd-proxy-injector
  apiGroup: rbac.authorization.k8s.io
---
kind: ServiceAccount
apiVersion: v1
metadata:
  name: linkerd-proxy-injector
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
---
kind: Secret
apiVersion: v1
metadata:
  name: linkerd-proxy-injector-k8s-tls
  namespace: linkerd
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
  annotations:
    linkerd.io/created-by: linkerd/cli stable-2.11.1
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVakNDQWpxZ0F3SUJBZ0lRRWRiVFNQMkxDSFZTSFRnOGROanNaakFOQmdrcWhraUc5dzBCQVFzRkFEQXQKTVNzd0tRWURWUVFERXlKc2FXNXJaWEprTFhCeWIzaDVMV2x1YW1WamRHOXlMbXhwYm10bGNtUXVjM1pqTUI0WApEVEl5TURJeE5USXlORGswTVZvWERUSXpNREl4TlRJeU5EazBNVm93TFRFck1Da0dBMVVFQXhNaWJHbHVhMlZ5ClpDMXdjbTk0ZVMxcGJtcGxZM1J2Y2k1c2FXNXJaWEprTG5OMll6Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQUQKZ2dFUEFEQ0NBUW9DZ2dFQkFNMnJqQVl3d0pWMXhhLzJXMlp5elBRNTc2RkFQQ2V1UCtnNHBhWHh4blFuSVY4VQo4aDVoZTluejdoN2R4R2Q5Z1RhY05UbHJhbmtzazFvcW4rR3VoTUU1aFAwUWFxL2hsL3hCS2Z5d3pxVUFyWUVECktRakE2VUVVeG1meE9jZmFXRGY2VWhpa21zc29JWnpNejl2UTAzcG9VZTBveVNtVEdHRUl2WnpVQTNpdXNQM0kKeFA0VlphRkJ3cEpyazhIMEgreWtkUnVjSUZpWStNNXRDQ3RTZlhQeDFWU3VCOGsvZHU3N0gwdUU5Q3FibE8wUQpPZEdweW5tOVhUeGN4dENtNjN3anJXTGdQTjRQS0hCR1gzQ3J6akZhbnJraFh4bjIrMUh3andpWlBqcnp3V1JFCjREOEFzZzU4eVo4THoxQUdSeXZ3Q1duTGhMZk1KeUIzbHNtNHVVa0NBd0VBQWFOdU1Hd3dEZ1lEVlIwUEFRSC8KQkFRREFnV2dNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RQpBakFBTUMwR0ExVWRFUVFtTUNTQ0lteHBibXRsY21RdGNISnZlSGt0YVc1cVpXTjBiM0l1YkdsdWEyVnlaQzV6CmRtTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBQlJYMzVYYkpwZWlVOVZ6M2lZcnBPaHkrQmJ2dkRPWnQvb3QKbzdvcWJnRVBHRmdZNU14dXRnWGZlVzBIQUpKTzZJQVBROWRFd3lKQkhpb1cwZ1B3Q1JoTlF0aCtxdGpqVm12bApUN1lGMmVnZ3oyYWc4K2t6UjhHRWk0bXk4WjVxTnc0TGw2eGpJRmlKUXZjczhGRURGV3dQWjFObE80VTBrazA3CnhFZCttVTlXa1RJVUVwOUJqT3RtV2o0WjBwUkt2L2hHWFpjak9VVThCVnpGSTRRYzE4S3UzNFRmQVhrQy96YjkKVkhkV1NwNTB1WmQ5Q2g3dGpFNFhTZFUvSnJyck9iMFN4SlNoSjZEa280TWFDdE0yS2FCOCtPVGx1bWpqeHpKVQpSR1AzcG12M3NWSFpYTlYrVEQxOGxKOW00ZGJ4cGZ5UmhpeHR6QWwxaTIyV3h4TFJOYnM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBemF1TUJqREFsWFhGci9aYlpuTE05RG52b1VBOEo2NC82RGlscGZIR2RDY2hYeFR5CkhtRjcyZlB1SHQzRVozMkJOcHcxT1d0cWVTeVRXaXFmNGE2RXdUbUUvUkJxcitHWC9FRXAvTERPcFFDdGdRTXAKQ01EcFFSVEdaL0U1eDlwWU4vcFNHS1NheXlnaG5NelAyOURUZW1oUjdTakpLWk1ZWVFpOW5OUURlSzZ3L2NqRQovaFZsb1VIQ2ttdVR3ZlFmN0tSMUc1d2dXSmo0em0wSUsxSjljL0hWVks0SHlUOTI3dnNmUzRUMEtwdVU3UkE1CjBhbktlYjFkUEZ6RzBLYnJmQ090WXVBODNnOG9jRVpmY0t2T01WcWV1U0ZmR2ZiN1VmQ1BDSmsrT3ZQQlpFVGcKUHdDeURuekpud3ZQVUFaSEsvQUphY3VFdDh3bklIZVd5Ymk1U1FJREFRQUJBb0lCQUdRRDdqMzhhMHJEVVBVMgoraytodUNWMEh5SHRXTk43R3p6VWYwbHBmN1p3YVB3UjlZUHNxQXZmWVliRkZZTzJOcVhWNU5RZGRsT2k1NjFMCldTQ29lNHB6YkVhY095VjRzUzVNaWh5RjVwZTY4cVR3WW40TlFlRVNOMEhJdnU1L01iTlhHYUUrT3NCY3JhdlEKdGF3UnF5VzFvVkdSS2ZIN3hEazd4T21FK0lNd29DeVFrSkpIMWFIYTJBT3VpVmMwbk1OZWEwS0Y3MllxZGhEUQp6cHJrdzBIL3pMKzd6ZXhQRmpkNXlNV0UyU3VpM2NvZmlrdXQwODV0WHJHY2lXWWpkK2RmMllnN1BHOE9TSW0zCmZPbmUxMklKS3A1eEdWUUdwb0NWMkx1d3RwV0tidzlwZzZVTk1ETXBVWDhHRnpNTW5TYXkrNDh5aVRyYVFzNHYKMFpESytOa0NnWUVBenhTTUkxVWdCRWdnQlZuZ2VrUGpqL0xNUnFmY0txTVBTbzN6S2MvUlNFVjhBWm9rRHB3YgowZmpXREFGc2ZsOG5RbGlaY2pIZGkrTUY1ZDhkMWN2TjJJWHZjOFhlUWdkMGpDUllKZTZWQkxHSXRORUlZK2RPCmZHQkdndTM0NmJ1bXFlWnExRTRJb045b3U0VnNWM1pUeVg0dTEyaEEvRkpaSW1VV3UzeUIyYjhDZ1lFQS9rRzMKNkQ1MVo3SktTZmJsY1VKUmY1c0lxVS9OWC9ya2h5T0UrVzRJZGNINnBnOFI1NER0YzdlSjJjd2xuSzlTNVRjNgpBR09ack5lMUVFUDdPLzEzanJ6aWx4U1RTT25EbUtaWWZjWk4yVWpPMzBJdGc3WWk4T3JKRjBITVFCT0c5RHJHClQxelhNQUtsUzcxaEpqS1NYL2FvWTNRVjhaaTN0MS9FNmNGazN2Y0NnWUFVUzRnOGdrQkVDeW1RUExIQ2Fkcm8KcGJ3ZGhLQVFVYkRTOXJ5Sk1ZUHFXRjBCN3pCdmVoOUQ0ZVpnZ05jNFAyMGlsSHBkZGNPbnpSVXI1VVVRU2d3ZgpsMmpUYU9ZU2hKYUlrWnRPQkdiNGNjbmJKczF5dFIyOUZOWjBTSXhubyt0K3BVVjlEelRMUjNvRlB0dFNheGRsCkhRZk1OcngvdmpaY0o1b2x2OXNlRXdLQmdRQ09rVE1hR3N1aVZhcXFSckxwQ3hLL3hxTFlyVkt2bXZOQmczMHcKajY1V3VXcGVhdHpUUHN2bXN1ZXRKSGVDb0J5UFFxUlhTNElFRlFBR0d0aHBEdnRYSWpxOEZHRng1UUkwT2pJcwpkR0Y2a1FUTzAwREtOZnJwcy8wRitYTWFDdGtGWVYrSmFMbVF4aXNCaVROTVE5Y24wQnNqaVJnMDNEbEhyWCt3Cnd5eFlpUUtCZ0c0T1J0bkVRZFlMN2FOZ0JMOEJLVW82dzdUeVZDYlhqRzZzaDBoSVEyT0V6d0VVTXZ2N0xyVUUKT0tqRjAvQzBXNHhSK2ZRd25OK3AwTysyL3VRbEtMN1QvWUtoTDY5NUo2RWdEcjVVRlk3b3N6eHZ2R1UzK0x0OQo3UTZ5VzErdkdjcjBGVVJ3clBGUzdtTWNURnp0SG9Vbzl6ZkFkMS9SRDgrckxZODZVUm9CCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0t
---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: linkerd-proxy-injector-webhook-config
  labels:
    linkerd.io/control-plane-component: proxy-injector
    linkerd.io/control-plane-ns: linkerd
webhooks:
- name: linkerd-proxy-injector.linkerd.io
  namespaceSelector:
    matchExpressions:
    - key: config.linkerd.io/admission-webhooks
      operator: NotIn
      values:
      - disabled
  clientConfig:
    service:
      name: linkerd-proxy-injector
      namespace: linkerd
      path: "/"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVakNDQWpxZ0F3SUJBZ0lRRWRiVFNQMkxDSFZTSFRnOGROanNaakFOQmdrcWhraUc5dzBCQVFzRkFEQXQKTVNzd0tRWURWUVFERXlKc2FXNXJaWEprTFhCeWIzaDVMV2x1YW1WamRHOXlMbXhwYm10bGNtUXVjM1pqTUI0WApEVEl5TURJeE5USXlORGswTVZvWERUSXpNREl4TlRJeU5EazBNVm93TFRFck1Da0dBMVVFQXhNaWJHbHVhMlZ5ClpDMXdjbTk0ZVMxcGJtcGxZM1J2Y2k1c2FXNXJaWEprTG5OMll6Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQUQKZ2dFUEFEQ0NBUW9DZ2dFQkFNMnJqQVl3d0pWMXhhLzJXMlp5elBRNTc2RkFQQ2V1UCtnNHBhWHh4blFuSVY4VQo4aDVoZTluejdoN2R4R2Q5Z1RhY05UbHJhbmtzazFvcW4rR3VoTUU1aFAwUWFxL2hsL3hCS2Z5d3pxVUFyWUVECktRakE2VUVVeG1meE9jZmFXRGY2VWhpa21zc29JWnpNejl2UTAzcG9VZTBveVNtVEdHRUl2WnpVQTNpdXNQM0kKeFA0VlphRkJ3cEpyazhIMEgreWtkUnVjSUZpWStNNXRDQ3RTZlhQeDFWU3VCOGsvZHU3N0gwdUU5Q3FibE8wUQpPZEdweW5tOVhUeGN4dENtNjN3anJXTGdQTjRQS0hCR1gzQ3J6akZhbnJraFh4bjIrMUh3andpWlBqcnp3V1JFCjREOEFzZzU4eVo4THoxQUdSeXZ3Q1duTGhMZk1KeUIzbHNtNHVVa0NBd0VBQWFOdU1Hd3dEZ1lEVlIwUEFRSC8KQkFRREFnV2dNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RQpBakFBTUMwR0ExVWRFUVFtTUNTQ0lteHBibXRsY21RdGNISnZlSGt0YVc1cVpXTjBiM0l1YkdsdWEyVnlaQzV6CmRtTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBQlJYMzVYYkpwZWlVOVZ6M2lZcnBPaHkrQmJ2dkRPWnQvb3QKbzdvcWJnRVBHRmdZNU14dXRnWGZlVzBIQUpKTzZJQVBROWRFd3lKQkhpb1cwZ1B3Q1JoTlF0aCtxdGpqVm12bApUN1lGMmVnZ3oyYWc4K2t6UjhHRWk0bXk4WjVxTnc0TGw2eGpJRmlKUXZjczhGRURGV3dQWjFObE80VTBrazA3CnhFZCttVTlXa1RJVUVwOUJqT3RtV2o0WjBwUkt2L2hHWFpjak9VVThCVnpGSTRRYzE4S3UzNFRmQVhrQy96YjkKVkhkV1NwNTB1WmQ5Q2g3dGpFNFhTZFUvSnJyck9iMFN4SlNoSjZEa280TWFDdE0yS2FCOCtPVGx1bWpqeHpKVQpSR1AzcG12M3NWSFpYTlYrVEQxOGxKOW00ZGJ4cGZ5UmhpeHR6QWwxaTIyV3h4TFJOYnM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0=
  failurePolicy: Ignore
  admissionReviewVersions: ["v1", "v1beta1"]
  rules:
  - operations: [ "CREATE" ]
    apiGroups: [""]
    apiVersions: ["v1"]
    resources: ["pods", "services"]
  sideEffects: None
